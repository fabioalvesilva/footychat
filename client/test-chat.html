<!DOCTYPE html>
<html>
<head>
    <title>FootyChat - Teste Chat</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; }
        #messages { border: 1px solid #ccc; height: 300px; overflow-y: auto; padding: 10px; margin: 20px 0; }
        .message { padding: 5px; margin: 5px 0; background: #f0f0f0; }
        button { margin: 5px; padding: 10px; }
        input { padding: 5px; width: 300px; }
    </style>
</head>
<body>
    <h1>FootyChat - Teste de Chat</h1>
    <div>Status: <span id="status">Desconectado</span></div>
    
    <div>
        <input id="token" placeholder="Cola o token aqui" style="width: 500px">
        <button onclick="connect()">Conectar</button>
    </div>
    
    <div>
        <input id="groupId" placeholder="Cola o GROUP_ID aqui">
        <input id="messageText" placeholder="Escreve uma mensagem">
        <button onclick="sendMessage()">Enviar</button>
    </div>
    
    <div id="messages"></div>

    <script>
        let socket;

        function connect() {
            const token = document.getElementById('token').value;
            
            socket = io('http://localhost:5000', {
                auth: { token }
            });

            socket.on('connect', () => {
                document.getElementById('status').innerHTML = 'ðŸŸ¢ Conectado!';
                socket.emit('join_groups');
            });

            socket.on('new_message', (data) => {
                const div = document.createElement('div');
                div.className = 'message';
                div.innerHTML = `<strong>${data.message.sender.name}:</strong> ${data.message.content.text}`;
                document.getElementById('messages').appendChild(div);
            });

            socket.on('error', (error) => {
                alert('Erro: ' + error.message);
            });
        }

        function sendMessage() {
            const groupId = document.getElementById('groupId').value;
            const text = document.getElementById('messageText').value;
            
            if (socket && groupId && text) {
                socket.emit('send_message', {
                    groupId: groupId,
                    text: text
                });
                document.getElementById('messageText').value = '';
            }
        }
    </script>
</body>
</html>